{% extends "base_livecode.html" %}

{% block title %}The reflective language Black{% endblock %}

{% block content %}
<h2>Warm up</h2>

<p>Just like Scheme... at first.
<div class="live" id="up0" data-lib="">
(+ 2 1)
(define inc (lambda (x) (+ x 1)))
(inc 2)
((lambda (x) (+ x 1)) 2)
(map inc '(1 2 3))
(map (lambda (x) (+ x 1)) '(1 2 3))
</div></p>

<p>Error loads new meta level.
<div class="live" id="up1" data-lib="up0">
(incr 2)
</div>
Notice the prompt change, from <code>0-7</code> to <code>1-0</code>.
The first number is the meta level, i.e. the <i>n</i> in meta<i><sup>n</sup></i> level. The second number is just the iteration counter at this level.</p>

<p>Two ways to go back down.</p>
<p>(1) call <code>old-cont</code>.
<div class="live" id="up2" data-lib="up0 up1">
(old-cont (lambda (x) (+ x 1)))
</div></p>
<p>(2) use <code>(base-eval <i>exp</i> <i>env</i> <i>cont</i>)</code>.
<div class="live" id="up3" data-lib="up0 up1">
(base-eval 1 '() (lambda (v) v))
incr ;; typo again
(base-eval 'inc old-env (lambda (v) v))
incr ;; typo again
(base-eval 'inc old-env old-cont)
</div></p>


<p>Notice we needed to quote <code>inc</code> at the meta-level. Why?
Let's jump back to the meta<sup>1</sup> level and see.
We can jump levels normally with <code>exit</code>, no need to fake errors.
<div class="live" id="up4" data-lib="up0">
(exit 'hello)

;; inc is not defined
inc
</div></p>

<p>Oh, we loaded meta<sup>2</sup> now! Let's go back to 0:
<div class="live" id="up5" data-lib="up0 up4">
(old-cont 1)
(old-cont 'back-to-user-level)
</div></p>

<p>To recap, a variable is local to a level:
<div class="live" id="up6" data-lib="">
(exit 'hello)
(define foo 1)
(old-cont foo)
;; foo is unbound at level 0
foo
;; but at level 1, it is defined
foo
;; going back again
(old-cont foo)
</div></p>

<p>Can we access some meta level without pushing away (or popping? which way does it go?) without leaving the level? Yes, with <code>EM</code>.
<div class="live" id="up7" data-lib="">
(EM foo)
(EM (define bar 2))
(EM bar)
bar ;; not bound

(EM (EM 1))
(EM (EM foo))
;; oops, we just loaded level 3
(old-cont 1)
</div>
Interesting, we got straight back to 0 from 3, some jumping indeed!</p>

{% endblock %}
